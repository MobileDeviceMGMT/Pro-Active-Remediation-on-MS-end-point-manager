[System.Collections.ArrayList]$global:JarFiles = @()
$logpath = "C:\temp\"
#Create logging
$now = get-date -Format "dd-MM-yyyy HH:mm:ss"
$now = $now.replace(" ","_")
$logfile = $env:COMPUTERNAME + "_" + $now + ".log"
$CTJar = $logfile.replace(".log",".csv")
$PathCheck = Test-Path $logpath  | Out-Null
If (!($pathcheck))
    {
    New-item $logpath -ItemType Directory | Out-Null
    }

$logging = $logpath + $logfile
Start-Transcript -Path $logging  | Out-Null
$SearchString = 'commons-text*.jar'
$JarFiles = Get-PSDrive | Where-Object { $_.Name.length -eq 1 } | Select-Object -ExpandProperty Root | Get-ChildItem -File -Recurse -Filter $SearchString -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName

if ($null -eq $jarfiles) { $global:result = "No Jar files found" }
else {
    $obj_jars = $jarFiles | Select-Object @{Name='Name';Expression={$_}}
    $obj_jars | Export-Csv $CTJar -NoType
    $global:result = "$($jarfiles.count) found, result in $CTJar"
    }
Write-Output "Result: $global:result"
Stop-Transcript  | Out-Null
